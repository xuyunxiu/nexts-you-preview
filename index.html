<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>NEXT’S YOU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin:0; font-family:sans-serif; background:#111; color:#fff; }
    nav { position:fixed; bottom:0; left:0; right:0; background:#000; display:flex; }
    nav button { flex:1; padding:12px; background:#000; color:#fff; border:none; }
    .page { display:none; padding:70px 16px 80px; }
    .active { display:block; }

    /* Friends tabs */
    .tabs { display:flex; border-bottom:1px solid #444; }
    .tabs button { flex:1; padding:10px; border:none; background:#111; color:#aaa; }
    .tabs button.active { color:#fff; border-bottom:2px solid #f00; }
    .friend-card { background:#222; margin:10px 0; padding:12px; border-radius:8px; }
    .friend-card img { width:40px; height:40px; border-radius:20px; vertical-align:middle; margin-right:8px; }
    .friend-card button { margin-top:8px; padding:6px 12px; border:none; border-radius:4px; background:#f00; color:#fff; }

    /* DM */
    .chat-box { background:#000; height:70vh; overflow-y:auto; padding:10px; }
    .bubble { background:#333; margin:5px 0; padding:8px 12px; border-radius:12px; max-width:70%; }
    .input-row { display:flex; }
    .input-row input { flex:1; padding:10px; border:none; }
    .input-row button { width:50px; background:#f00; border:none; color:#fff; }

    /* Album modal */
    #albumModal { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.9); display:none; }
    #albumModal .content { padding:20px; }
    #albumModal img { width:100%; margin-bottom:10px; }

    /* Live */
    .live-artist { background:#222; padding:20px; border-radius:8px; margin-bottom:12px; }
    .live-fans { max-height:40vh; overflow-y:auto; background:#111; padding:10px; }
    .fan-msg { background:#333; margin:5px 0; padding:6px 10px; border-radius:8px; }

    /* Wallet */
    .wallet button { display:block; margin:12px auto; padding:10px 20px; background:#f00; border:none; color:#fff; border-radius:6px; }
  </style>
</head>
<body>

<!-- Friends -->
<div id="friends" class="page active">
  <h2>Friends</h2>
  <div class="tabs">
    <button onclick="filterFriends('artist')" class="active">藝人</button>
    <button onclick="filterFriends('group')">團體</button>
    <button onclick="filterFriends('purchased')">已購買</button>
    <button onclick="filterFriends('unpurchased')">未購買</button>
  </div>
  <div id="friendsList"></div>
</div>

<!-- DM list -->
<div id="dmList" class="page">
  <h2>DM 聊天室</h2>
  <div id="dmRooms"></div>
</div>

<!-- DM chat -->
<div id="dmChat" class="page">
  <h2 id="chatTitle"></h2>
  <button onclick="openAlbum()" style="position:absolute; right:16px; top:70px;">📷</button>
  <div id="chatBox" class="chat-box"></div>
  <div class="input-row">
    <input id="chatInput" placeholder="輸入訊息..."/>
    <button onclick="sendMessage()">➤</button>
  </div>
</div>

<!-- Album -->
<div id="albumModal">
  <div class="content">
    <h3>相簿</h3>
    <img src="https://placekitten.com/400/300">
    <img src="https://placekitten.com/401/301">
    <button onclick="closeAlbum()">關閉</button>
  </div>
</div>

<!-- Live -->
<div id="live" class="page">
  <h2>文字直播</h2>
  <div class="live-artist" id="liveArtist">
    <strong>主播：</strong> 오늘 TMI 알려줄게요~
  </div>
  <div class="live-fans" id="liveFans"></div>
  <div class="input-row">
    <input id="fanInput" placeholder="輸入留言..."/>
    <button onclick="sendFanMsg()">送出</button>
  </div>
</div>

<!-- Wallet -->
<div id="wallet" class="page wallet">
  <h2>錢包</h2>
  <button onclick="markPurchased('ALDAY')">購買團體 pass</button>
  <button onclick="markPurchased('WOOCHAN')">購買 Woochan pass</button>
</div>

<nav>
  <button onclick="showPage('friends')">首頁</button>
  <button onclick="showPage('dmList')">DM</button>
  <button onclick="showPage('live')">直播</button>
  <button onclick="showPage('wallet')">錢包</button>
</nav>

<script>
  let purchased = {}; // 存購買狀態
  let friends = [
    {id:"ALDAY", name:"ALLDAY PROJECT", type:"group", img:"https://placekitten.com/80/80", bg:"#333"},
    {id:"WOOCHAN", name:"Woochan", type:"artist", img:"https://placekitten.com/81/81", bg:"#444"},
    {id:"ANNIE", name:"Annie", type:"artist", img:"https://placekitten.com/82/82", bg:"#555"}
  ];

  function showPage(id){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  function renderFriends(filter="artist"){
    let list=document.getElementById("friendsList");
    list.innerHTML="";
    let data=friends.filter(f=>{
      if(filter==="artist") return f.type==="artist";
      if(filter==="group") return f.type==="group";
      if(filter==="purchased") return purchased[f.id];
      if(filter==="unpurchased") return !purchased[f.id];
    });
    data.forEach(f=>{
      let card=document.createElement("div");
      card.className="friend-card";
      card.innerHTML=`<img src="${f.img}">${f.name}<br>
      <button onclick="enterProfile('${f.id}')">開始聊天</button>`;
      list.appendChild(card);
    });
  }

  function filterFriends(mode){
    document.querySelectorAll('.tabs button').forEach(b=>b.classList.remove('active'));
    event.target.classList.add('active');
    renderFriends(mode);
  }

  function enterProfile(id){
    if(purchased[id]){
      openChat(id);
    } else {
      showPage("wallet");
    }
  }

  function openChat(id){
    showPage("dmChat");
    document.getElementById("chatTitle").innerText=friends.find(f=>f.id===id).name;
    let box=document.getElementById("chatBox");
    box.innerHTML=`<div class="bubble">歡迎來到 ${id} DM！</div>`;
    box.scrollTop=box.scrollHeight;
  }

  function sendMessage(){
    let val=document.getElementById("chatInput").value;
    if(!val) return;
    let box=document.getElementById("chatBox");
    let msg=document.createElement("div");
    msg.className="bubble";
    msg.style.background="#f00";
    msg.innerText=val;
    box.appendChild(msg);
    document.getElementById("chatInput").value="";
    box.scrollTop=box.scrollHeight;
  }

  function openAlbum(){ document.getElementById("albumModal").style.display="block"; }
  function closeAlbum(){ document.getElementById("albumModal").style.display="none"; }

  function sendFanMsg(){
    let val=document.getElementById("fanInput").value;
    if(!val) return;
    let box=document.getElementById("liveFans");
    let div=document.createElement("div");
    div.className="fan-msg";
    div.innerText=val;
    box.appendChild(div);
    document.getElementById("fanInput").value="";
    box.scrollTop=box.scrollHeight;
  }

  function markPurchased(id){
    purchased[id]=true;
    alert("已購買 " + id);
    renderFriends();
  }

  renderFriends();
</script>
</body>
</html>
